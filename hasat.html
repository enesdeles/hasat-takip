<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Domates SerasÄ± Hasat Takip</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  margin:20px;
}
h2{margin-bottom:10px}
table{
  border-collapse:collapse;
  width:100%;
  background:white;
}
th,td{
  border:1px solid #ccc;
  padding:6px;
  text-align:center;
}
th{
  background:#2e7d32;
  color:white;
}
input{
  width:95%;
  padding:4px;
}
button{
  margin-top:10px;
  padding:10px 20px;
  font-size:16px;
  background:#2e7d32;
  color:white;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
button:hover{background:#256628}
</style>
</head>

<body>

<h2>ðŸŒ± Domates SerasÄ± Hasat Takip</h2>

<table id="hasatTable">
<thead>
<tr>
<th>TÃ¼nel</th>
<th>YÃ¶n</th>
<th>SÄ±ra</th>
<th>Personel</th>
<th>Kutu</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button onclick="pdfOlustur()">ðŸ“„ PDF Ä°ndir</button>

<script>
// UTF-8 DÃœZELTME
function trFix(text){
  return text
    .replace(/Ä°/g,"I")
    .replace(/Ä±/g,"i")
    .replace(/Åž/g,"S")
    .replace(/ÅŸ/g,"s")
    .replace(/Äž/g,"G")
    .replace(/ÄŸ/g,"g")
    .replace(/Ãœ/g,"U")
    .replace(/Ã¼/g,"u")
    .replace(/Ã–/g,"O")
    .replace(/Ã¶/g,"o")
    .replace(/Ã‡/g,"C")
    .replace(/Ã§/g,"c");
}

const tbody=document.querySelector("#hasatTable tbody");

// TABLO OLUÅžTUR
for(let t=19;t>=1;t--){
  let sides=(t>=10)?["Kuzey","GÃ¼ney"]:[""];
  sides.forEach(side=>{
    for(let r=1;r<=6;r++){
      let tr=document.createElement("tr");
      tr.innerHTML=`
        <td>${t}</td>
        <td>${side}</td>
        <td>${r}</td>
        <td><input></td>
        <td><input type="number"></td>
      `;
      tbody.appendChild(tr);
    }
  });
}

// PDF
function pdfOlustur(){
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF("p","mm","a4");

  let y=15;
  let toplam=0;

  doc.setFont("helvetica","normal");
  doc.setFontSize(12);
  doc.text("Domates Serasi Hasat Kaydi",10,y);
  y+=8;

  doc.setFontSize(9);
  doc.text("Tunel",10,y);
  doc.text("Yon",25,y);
  doc.text("Sira",45,y);
  doc.text("Personel",60,y);
  doc.text("Kutu",140,y);
  y+=5;
  doc.line(10,y,200,y);
  y+=4;

  document.querySelectorAll("tbody tr").forEach(tr=>{
    const td=tr.querySelectorAll("td");
    const personel=td[3].querySelector("input").value;
    const kutu=parseInt(td[4].querySelector("input").value)||0;

    if(personel!=="" || kutu>0){
      doc.text(td[0].innerText,10,y);
      doc.text(trFix(td[1].innerText),25,y);
      doc.text(td[2].innerText,45,y);
      doc.text(trFix(personel),60,y);
      doc.text(kutu.toString(),140,y);

      toplam+=kutu;
      y+=6;

      if(y>280){
        doc.addPage();
        y=15;
      }
    }
  });

  doc.line(10,y,200,y);
  y+=8;
  doc.setFontSize(11);
  doc.text(`TOPLAM KUTU: ${toplam}`,10,y);

  doc.save("hasat_kaydi.pdf");
}
</script>

</body>
</html>