<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>√ñl√º Bitki Takip</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#6a1b9a">

<style>
body{font-family:Arial;background:#f4f6f8;margin:0;padding:10px}
h1{text-align:center;color:#6a1b9a}
button{width:100%;padding:12px;margin-top:8px;font-size:16px;background:#6a1b9a;color:#fff;border:none;border-radius:6px}
button.small{padding:6px;font-size:14px}
button.red{background:#c62828}
.section{background:#fff;padding:10px;margin-bottom:10px;border-radius:6px}
.hidden{display:none}
table{width:100%;border-collapse:collapse;background:#fff}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
th{background:#ede7f6}
select{width:95%;padding:6px}
#total{text-align:center;font-size:18px;font-weight:bold;margin-top:10px}
@media print{
button,.section{display:none}
select{border:none;appearance:none}
#total{font-size:20px;border-top:2px solid #000;padding-top:10px}
}
</style>
</head>

<body>

<h1>üåø √ñl√º / Kesilen Bitki Takibi</h1>

<button onclick="location.href='index.html'">
üå± Hasat Takibe Geri D√∂n
</button>

<table id="table">
<tr>
<th>T√ºnel</th>
<th>Sƒ±ra</th>
<th>Personel</th>
<th>Kesilen Bitki</th>
</tr>
</table>

<div id="total">Toplam Kesilen Bitki: 0</div>
<button onclick="window.print()">PDF ƒ∞ndir</button>
<button class="red" onclick="clearPage()">üóëÔ∏è Sayfayƒ± Temizle</button>

<script>
const PERSONEL_KEY="sera_personeller";
const DATA_KEY="olu_bitki_kayitlar";

let personeller=JSON.parse(localStorage.getItem(PERSONEL_KEY))||[];
let kayitlar=JSON.parse(localStorage.getItem(DATA_KEY))||{};

function personelSelect(id){
let h=`<select onchange="saveValue('${id}','p',this.value)">`
h+=`<option value="">Se√ß</option>`
personeller.forEach(p=>h+=`<option>${p}</option>`)
h+=`</select>`
return h
}

function bitkiSelect(id){
let h=`<select onchange="saveValue('${id}','b',this.value);calc()">`
for(let i=0;i<=500;i++)h+=`<option>${i}</option>`
h+=`</select>`
return h
}

function saveValue(id,t,v){
kayitlar[id]=kayitlar[id]||{}
kayitlar[id][t]=v
localStorage.setItem(DATA_KEY,JSON.stringify(kayitlar))
}

function restore(id,t){return kayitlar[id]?.[t]||""}

const table=document.getElementById("table")
for(let t=19;t>=1;t--){
for(let s=1;s<=6;s++){
const id=`${t}-${s}`
const tr=document.createElement("tr")
tr.innerHTML=`<td>${t}</td><td>${s}</td>
<td>${personelSelect(id)}</td>
<td>${bitkiSelect(id)}</td>`
table.appendChild(tr)
tr.querySelector("td:nth-child(3) select").value=restore(id,"p")
tr.querySelector("td:nth-child(4) select").value=restore(id,"b")
}
}

function calc(){
let t=0
document.querySelectorAll("td:nth-child(4) select").forEach(s=>t+=Number(s.value))
document.getElementById("total").innerText="Toplam Kesilen Bitki: "+t
}

function clearPage(){
if(!confirm("T√ºm kayƒ±tlar silinsin mi?"))return
kayitlar={}
localStorage.removeItem(DATA_KEY)
document.querySelectorAll("select").forEach(s=>s.value="")
calc()
}

calc()
</script>
</body>
</html>
